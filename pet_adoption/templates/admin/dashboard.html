<!--
  References:
  - https://www.ezzeddinabdullah.com/post/frontend-crud-flask-jinja-bootstrap/
  - https://www.w3schools.com/howto/howto_css_modals.asp
  - https://flask-wtf.readthedocs.io/en/1.0.x/quickstart/
  - https://stackabuse.com/flask-form-validation-with-flask-wtf/
  - https://hackersandslackers.com/flask-routes/
-->
  
{% extends 'base.html' %}

{% block title %} Admin Dashboard {% endblock %}
		
{% block content %}

	<!-- Flash messages -->
	{% with messages = get_flashed_messages(with_categories=true) %}
		{% if messages %}
			{% for category, message in messages %}
				<div class="alert alert-{{ category }}">{{ message }}</div>
			{% endfor %}
		{% endif %}
	{% endwith %}

	<div id="browse">
		<h1>Pet Management Dashboard</h1>

		<div class="action-buttons">
			<a href="{{ url_for('admin.create_pet') }}" class="btn btn-primary">+ Add New Pet</a>
		</div>

		<table class="table" border="1" cellpadding="5">
			{% if animals and animals|length > 0 %}
				<thead>
					<tr>
						<th>Pet Name</th>
						<th>Type</th>
						<th>Availability</th>
						<th>Breed</th>
						<th>Description</th>
						<th>Disposition</th>
						<th>News Items</th>
						<th>Images</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
				{% for animal in animals %}
					<tr>
						<td>{{ animal.name }}</td>
						<td>{{ animal.type }}</td>
						<td>{{ animal.availability }}</td>
						<td>{{ animal.breed }}</td>
						<td>{{ animal.description }}</td>
						<td>{{ animal.disposition | join(', ') }}</td>
						<td>{{ animal.news_item }}</td>
						<td>{% if animal.public_image %}Image{% else %}--{% endif %}</td>
						<td>
							<a href="{{ url_for('admin.edit_pet', id=animal._id) }}" class="btn btn-success">Edit</a>
							<form action="{{ url_for('admin.delete_pet', id=animal._id) }}" method="post" style="display:inline">
								{% if csrf_token is defined %}
									<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
								{% endif %}
								<button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
							</form>
						</td>
					</tr>
				{% endfor %}
				</tbody>
			{% else %}
				<tr><td colspan="9" style="text-align: center;">No pets available. <a href="{{ url_for('admin.create_pet') }}">Add one now</a>!</td></tr>
			{% endif %}
		</table>
	</div>

{% endblock %}